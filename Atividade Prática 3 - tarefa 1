# Importa√ß√£o das bibliotecas 
import yfinance as yf
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from datetime import datetime, timedelta

# Defini√ß√£o do per√≠odo e dos ativos
start_date = '2010-01-01'
end_date = '2025-09-18'

empresa_ticker = 'CSNA3.SA'
ibov_ticker = '^BVSP'

# Download dos dados da empresa
dados_empresa = yf.download(empresa_ticker, start=start_date, end=end_date, progress=False, auto_adjust=True) 
dados_empresa = dados_empresa[['Close']]  # Manter apenas pre√ßos de fechamento ajustado

# Download dos dados do Ibovespa
dados_ibov = yf.download(ibov_ticker, start=start_date, end=end_date, progress=False, auto_adjust=True)
dados_ibov = dados_ibov[['Close']]  # Manter apenas pre√ßos de fechamento ajustado

# Dados para confer√™ncia
# Retornos di√°rios da empresa
retornos_empresa_diarios = dados_empresa['Close'].pct_change().dropna()
retornos_empresa_diarios.name = 'Retorno Di√°rio'

print("Retornos di√°rios da empresa:")
display(retornos_empresa_diarios.head())

# Pre√ßos mensais
precos_mensais_ibov = dados_ibov['Close'].resample('ME').last()

# Retornos mensais do Ibovespa
retornos_ibov_mensais = precos_mensais_ibov.pct_change().dropna()
retornos_ibov_mensais.name = 'Retorno Mensal Ibov'

# Exibir os primeiros retornos mensais do Ibovespa como tabela
print("Retornos mensais do Ibovespa:")
display(retornos_ibov_mensais.head())
print("Dados da empresa:") 
display(dados_empresa.head()) 
print("\nDados do Ibovespa:") 
display(dados_ibov.head())

# auto_adjust=True ‚Üí ajusta os pre√ßos automaticamente (dividendos, splits, etc.)
# --- Estat√≠sticas descritivas dos retornos di√°rios da empresa ---
print("üìä Estat√≠sticas - Retornos di√°rios da CSNA3:")
display(retornos_empresa_diarios.describe())

# --- Estat√≠sticas descritivas dos retornos mensais do Ibovespa ---
print("\nüìä Estat√≠sticas - Retornos mensais do Ibovespa:")
display(retornos_ibov_mensais.describe())
